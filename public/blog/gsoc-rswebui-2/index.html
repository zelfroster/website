<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="No Description"><link rel=canonical href=https://zelfroster.com/blog/gsoc-rswebui-2/><link rel="shortcut icon" href=/favicon.ico><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="GSoCâ€™23 : Implementation of Web Interface of Retroshare - Part 2"><meta property="og:description" content="No Description"><meta property="og:url" content="https://zelfroster.com/blog/gsoc-rswebui-2/"><meta property="og:site_name" content="Zelfroster"><meta property="og:image" content="img/favicon/%!s(MISSING).png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="600"><meta property="article:published_time" content="2023-08-10 13:58:18 +0530 IST"><title>GSoCâ€™23 : Implementation of Web Interface of Retroshare - Part 2 - Zelfroster</title><style>html{scroll-behavior:smooth;scroll-padding:1rem}body{max-width:800px;margin:auto;padding:1rem;font-family:Helvetica,sans-serif;line-height:1.5;min-height:95vh;display:flex;flex-direction:column}nav{margin-top:.5rem;font-family:monospace}nav a{padding:.175rem .275rem}.article-meta,footer,nav{text-align:center}.title{font-size:1.1rem}footer{font-family:monospace}footer a{text-decoration:none}hr{border-style:dashed;color:#ddd}.article-meta,.fancy-box,pre{border:1px solid #ddd;box-shadow:5px 5px 5px #eee;padding:1rem;overflow-x:auto}code{background:#f0f0f0;padding:.125rem .25rem}pre{background:0 0!important}pre code{padding:0}a{color:#0060f0}a:hover{text-decoration:none}h1>a,h2>a,h3>a{display:none;text-decoration:none}h1:hover>a,h2:hover>a,h3:hover>a{display:inline}ul{padding-left:1rem}iframe,img,video{max-width:100%}main{hyphens:auto;margin-bottom:auto}blockquote{background:#f2f2f2;border-left:4px solid #0080f0;padding:.125rem .5rem;margin:0}blockquote p{margin:.25rem}table{margin:auto;border-top:1px solid #666;border-bottom:1px solid #666}table thead th{border-bottom:1px solid #ddd}td,th{padding:5px}tfoot,thead,tr:nth-child(even){background:#eee}article header{margin-bottom:1rem}.zel-avatar{float:right;min-width:3rem;max-width:15%;border-radius:50%;border:5px solid #fff;box-shadow:0 4px 5px 2px #eee}.article-item{display:flex}.pagination{display:flex;justify-content:space-between}summary{margin-top:1rem}@media(max-width:480px){.zel-avatar{border-width:3px;transform:translateY(.5rem)}.article-item{padding:.25rem 0}.article-date{display:none}}@media(prefers-color-scheme:dark){html{background:#1e2326;color:#d5cebf}p{color:#c5beaf}a{color:#24d1ac}.zel-avatar{border-color:#d5cebf22;box-shadow:0 4px 5px 2px #333333aa}.article-meta,.fancy-box,pre{border:1px solid #d5cebf55;box-shadow:5px 5px 5px #333333aa}blockquote{background:#272e33;border-left:4px solid #24d1ac}pre{background:#272e33!important}code{background:#2e383c}hr{color:#7a8478}svg path{stroke:#d5cebf}}</style><body><header><nav><a href=https://zelfroster.com/>Home</a>
<a href=/blog/>Writings</a>
<a href=https://portfolio.zelfroster.com target=_blank>Portfolio</a>
<a href=https://zelfroster.com/index.xml>RSS</a></nav><hr></header><main><article id=content><header class=article-meta><h1 id=title>GSoCâ€™23 : Implementation of Web Interface of Retroshare - Part 2</h1><div id=meta><p id=date><b>Posted:</b>
Aug 10, 2023 &#183;
<b id=wordcount>9 minutes read</b></p></div></header><p>Hello again folks ðŸ‘‹ ,
If this is your first time here, then consider reading <a href=https://blog.freifunk.net/2023/05/22/gsoc23-implementation-of-webui-of-retroshare/>Part 1</a> of this blog.</p><blockquote><p>This is a mirror of the <a href=https://blog.freifunk.net/2023/07/08/gsoc23-implementation-of-web-interface-of-retroshare-part-2/>post</a> which I wrote recently on Freifunk.</p></blockquote><p>Now, letâ€™s continue.
The first phase of GSoC has been amazing, up until now. I was able to implement
a lot of features, fixed bugs and issues, faced difficulties, got stuck and
learned a lot. I am going to discuss my journey so far, so buckle up your seat
belts.</p><h2 id=progress-on-the-webui>Progress on the WebUI<a href=#progress-on-the-webui class=hanchor arialabel=Anchor> # &nbsp;</a></h2><p>I have been able to improve the Web Interface of Retroshare very much in terms
of usability and a better UI. All thanks to my mentors and the community
members.
<img src=https://blog.freifunk.net/wp-content/uploads/2023/07/Retroshare2-1536x841.png alt="Retroshare HomePage">
Here is what the homepage looks right now.</p><h3 id=file-search-feature>File Search feature<a href=#file-search-feature class=hanchor arialabel=Anchor> # &nbsp;</a></h3><p>During the start of the Coding Period, I was already working on implementing the
File Search feature, so naturally It was completed in the first week of GSoC
itself. This was a very difficult feature to implement as there were only a few
options on how to do it correctly.</p><p>Previously, the file search results data was sent as a response to the request
made to the endpoint <code>/rsFiles/turtleSearchRequest</code>. So, I thought of using
<a href=https://developer.mozilla.org/en-US/docs/Web/API/EventSource>Event Source</a>, as It would create a persistent connection to get the data in
stream. But it needed its own auth headers to be used properly. Also, there was
some issue in the format of response coming from the backend, which was causing
webui to crash. I had a discussion upon this with the mentors in the <a href=https://github.com/RetroShare/RSNewWebUI/issues/73>issue</a> I
created on GitHub.</p><p>Later the mentors discussed and decided that It would be better to make the
results of file search as a stream of events which would be then captured at the
frontend side and displayed. As there was already a way to handle events, It was
not much of a problem. But the real issue was to update them in the UI after
capturing them, as I was not sure how to do that in Mithril.js, and this was a
perfect opportunity to learn something new.</p><p>And after some research, I found out that <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy>Proxy</a> in JavaScript can be used to
check for any change in the objects made using the handler defined in
<code>eventQueue</code>. And, then I could manually trigger a re-render using <code>m.redraw()</code> in
mithril.js to update the results in the UI.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#888;font-style:italic>// Custom Proxy code
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#888;font-style:italic></span><span style=font-weight:700;text-decoration:underline>const</span> createArrayProxy = (arr, onChange) =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  <span style=font-weight:700;text-decoration:underline>return</span> <span style=font-weight:700;text-decoration:underline>new</span> <span style=font-weight:700;font-style:italic>Proxy</span>(arr, {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    set: (target, property, value, reciever) =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>      <span style=font-weight:700;text-decoration:underline>const</span> success = Reflect.set(target, property, value, reciever);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>      <span style=font-weight:700;text-decoration:underline>if</span> (success &amp;&amp; onChange) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>        onChange();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>      }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>      <span style=font-weight:700;text-decoration:underline>return</span> success;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    },
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  });
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=font-weight:700;text-decoration:underline>const</span> createProxy = (obj, onChange) =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  <span style=font-weight:700;text-decoration:underline>return</span> <span style=font-weight:700;text-decoration:underline>new</span> <span style=font-weight:700;font-style:italic>Proxy</span>(obj, {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>    get: (target, property, reciever) =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>      <span style=font-weight:700;text-decoration:underline>const</span> value = Reflect.get(target, property, reciever);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>      <span style=font-weight:700;text-decoration:underline>return</span> <span style=font-weight:700;text-decoration:underline>typeof</span> value === <span style=color:#666;font-style:italic>&#34;object&#34;</span> &amp;&amp; value !== <span style=font-weight:700;text-decoration:underline>null</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>        ? <span style=font-weight:700;font-style:italic>Array</span>.isArray(value)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>          ? createArrayProxy(value, onChange)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>          : createProxy(value, onChange)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>        : value;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>    },
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>    set: (target, property, value, reciever) =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>      <span style=font-weight:700;text-decoration:underline>const</span> success = Reflect.set(target, property, value, reciever);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>      <span style=font-weight:700;text-decoration:underline>if</span> (success &amp;&amp; onChange) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>        onChange();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>      }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>      <span style=font-weight:700;text-decoration:underline>return</span> success;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>    },
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>  });
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=font-weight:700;text-decoration:underline>const</span> proxyObj = createProxy({}, () =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>  m.redraw();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>});
</span></span></code></pre></div><p>So, after some head banging and googling, I was able to implement this feature.
Furthermore, I improved the small issues in next iterations. You can see the
merged PR <a href=https://github.com/RetroShare/RSNewWebUI/pull/74>here</a>.</p><p><img src=https://blog.freifunk.net/wp-content/uploads/2023/07/image-8-1536x841.png alt="RetroShare File Search">
This is how the File Search looks currently.</p><h3 id=config-mail>Config Mail<a href=#config-mail class=hanchor arialabel=Anchor> # &nbsp;</a></h3><p>After that, I started working on the config section, in which I implemented the
feature to create and manage custom tags for mails in the mail config. The PR I
raised is <a href=https://github.com/RetroShare/RSNewWebUI/pull/75>here</a>.
<img src=https://blog.freifunk.net/wp-content/uploads/2023/07/image-9-1536x841.png alt="RetroShare Config Mail"></p><h3 id=config-network>Config Network<a href=#config-network class=hanchor arialabel=Anchor> # &nbsp;</a></h3><p>Then, I implemented some missing features in existing section of Config section.
In the Network config, some options werenâ€™t working. So, after discussing with
my mentor, I implemented the Hidden Network Configuration for TOR/I2P Socks
Proxy <a href=https://github.com/RetroShare/RSNewWebUI/pull/76>here</a>.
<img src=https://blog.freifunk.net/wp-content/uploads/2023/07/image-10-1536x841.png alt="RetroShare Config Network"></p><h3 id=config-files>Config Files<a href=#config-files class=hanchor arialabel=Anchor> # &nbsp;</a></h3><p>I implemented the missing options as well as fixed the options which were not
working in the config files section also for this, I implemented the
<code>getQueueSize()</code> function in libretroshare.
<img src=https://blog.freifunk.net/wp-content/uploads/2023/07/image-12-1024x560.png alt="RetroShare Config Files"></p><p>By this time, I was also getting a hang of How things were working internally in
the <a href=https://github.com/RetroShare/libretroshare>libretroshare</a>. And, my mentor <a href=https://github.com/csoler>Cyril Soler</a> motivated me and supported me to
start writing code in libretroshare for Doxygen to generate the JSON API for the
required endpoint. I raised three PRs in total, where I also implemented an
endpoint in the actual <code>C++</code> code.</p><p>Honestly, this was more satisfying to be able to do this rather than writing
code for the webui. You can view all of my libretroshare PRs <a href="https://github.com/RetroShare/libretroshare/pulls?q=is%3Apr+author%3Azelfroster+is%3Aclosed">here</a>.</p><h3 id=fix-ui-of-whole-interface>Fix UI of whole Interface<a href=#fix-ui-of-whole-interface class=hanchor arialabel=Anchor> # &nbsp;</a></h3><p>This was a very big task but didnâ€™t take that long, I did it gradually in small
bits. Improved the whole UI of the web interface, and it looks much better now.
See all the changes made in this PR <a href=https://github.com/RetroShare/RSNewWebUI/pull/77>here</a>.
I would not include any screenshots here as It would be too much.</p><h3 id=fix-working-and-ui-of-mail-composer>Fix working and UI of mail Composer<a href=#fix-working-and-ui-of-mail-composer class=hanchor arialabel=Anchor> # &nbsp;</a></h3><p>Of all the features I have implemented so far, none of this were this confusing
where I was fighting with the code. I was stuck trying this on my own for two
days, since the code I wrote was fine on its own. But, there was something which
was causing an issue, and I was not able to understand what it was. So finally,
I asked for help from a community member, <a href=https://github.com/rottencandy>M. Saud</a>. He is also the code reviewer
of all of my PRs, since as far as I know he is the only JS dev in RSWebUI team.</p><p>He found the issue and told me some ways It could be done. Those seemed too
complex to me, I read some mithril.js docs and tried to figure out ways to do
it. And In the end, I found a very easy way to do it. You can read the
discussion <a href=https://github.com/RetroShare/RSNewWebUI/pull/77#issuecomment-1614640284>here</a> on GitHub.</p><p><img src=https://blog.freifunk.net/wp-content/uploads/2023/07/image-11-1024x560.png alt="Retroshare Mail Composer">
This is how the mail composer looks.</p><p>This PR is related to the mail reply as well, so this is still in the Draft
version, And I am currently working on it to implement the features. You can see
it <a href=https://github.com/RetroShare/RSNewWebUI/pull/80>here</a>. Other than this, I have been doing some minor fixes and refactoring in
the whole webui along with completing the major goals in the timeline.</p><p>So, this is the progress made in the WebUI until now. And, I have learned and still learning many new things while working on it.</p><h2 id=whats-next>What&rsquo;s Next?<a href=#whats-next class=hanchor arialabel=Anchor> # &nbsp;</a></h2><p>First, I will finish the <a href=https://github.com/RetroShare/RSNewWebUI/pull/80>PR#80</a> where I have to implement the Reply feature in
the Mail Section, and then will work on the next set of goals as mentioned in
the timeline which are :</p><ul><li>Forums Section<ul><li>Implement the remaining features from the Qt app in the forum section.</li><li>Implement a better layout of the forum and posts view, comment and reply feature etc.</li></ul></li><li>Boards and Channel Section<ul><li>Implement the remaining features and make them more user-friendly and easy to use.</li></ul></li><li>Implement a feature for Configuring and Visualizing own shared files with features such as managing shared directories, user permissions etc.</li></ul><p>Apart from these goals, I have also discussed with my mentor to work on more
important issues and necessary features for the upcoming release of the webui.</p><p>Now, I will see you in the next and final blog of this GSoC series.</p><p>Thanks for reading and have a great day : )</p><footer><div class=pagination><a class=previous href=https://zelfroster.com/blog/gsoc-rswebui-1/>&lt;&lt; GSoCâ€™23 : â€¦</a></div></footer></article></main><footer><hr><span style=font-family:sans-serif>&copy;</span> 2023 <a href=https://zelfroster.com>zelfroster</a>.</footer></body></html>